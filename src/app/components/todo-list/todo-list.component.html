<div class="todo-list-container">
  <!-- Search & Filter Bar -->
  <div class="filters-bar">
    <div class="search-box">
      <span class="search-icon">ğŸ”</span>
      <input 
        type="text" 
        placeholder="Search todos..." 
        [value]="searchQuery()"
        (input)="onSearch($event)">
    </div>
    <select class="filter-select" [value]="statusFilter()" (change)="onFilterChange($event)">
      <option value="all">All Status</option>
      <option value="pending">â³ Pending</option>
      <option value="in-progress">ğŸ”„ In Progress</option>
      <option value="completed">âœ… Completed</option>
    </select>
    @if (searchQuery() || statusFilter() !== 'all') {
      <button class="btn-clear" (click)="clearFilters()">âœ• Clear</button>
    }
  </div>

  @if (loading()) {
    <div class="loading">Loading todos...</div>
  } @else if (filteredTodos().length === 0) {
    <div class="empty-state">
      @if (todos().length === 0) {
        <p>No todos yet. Create your first one!</p>
      } @else {
        <p>No todos match your search.</p>
        <button class="btn-link" (click)="clearFilters()">Clear filters</button>
      }
    </div>
  } @else {
    @if (groupedTodos().today.length > 0) {
      <section class="todo-section">
        <h2 class="section-title">ğŸ“… Today</h2>
        @for (todo of groupedTodos().today; track todo.id) {
          <div class="todo-card" [class]="getStatusClass(todo.status)">
            <div class="todo-content">
              <h3 class="todo-title">{{ todo.title }}</h3>
              <p class="todo-description">{{ todo.description }}</p>
              <div class="todo-meta">
                <span class="status-badge" [class]="getStatusClass(todo.status)">{{ todo.status }}</span>
                <span class="date">{{ formatDate(todo.createdAt) }}</span>
              </div>
            </div>
            <div class="todo-actions">
              <a [routerLink]="['/edit', todo.id]" class="btn btn-sm btn-edit">âœï¸ Edit</a>
              <button class="btn btn-sm btn-delete" (click)="deleteTodo(todo)">ğŸ—‘ï¸</button>
            </div>
          </div>
        }
      </section>
    }
    @if (groupedTodos().yesterday.length > 0) {
      <section class="todo-section">
        <h2 class="section-title">ğŸ“† Yesterday</h2>
        @for (todo of groupedTodos().yesterday; track todo.id) {
          <div class="todo-card" [class]="getStatusClass(todo.status)">
            <div class="todo-content">
              <h3 class="todo-title">{{ todo.title }}</h3>
              <p class="todo-description">{{ todo.description }}</p>
              <div class="todo-meta">
                <span class="status-badge" [class]="getStatusClass(todo.status)">{{ todo.status }}</span>
                <span class="date">{{ formatDate(todo.createdAt) }}</span>
              </div>
            </div>
            <div class="todo-actions">
              <a [routerLink]="['/edit', todo.id]" class="btn btn-sm btn-edit">âœï¸ Edit</a>
              <button class="btn btn-sm btn-delete" (click)="deleteTodo(todo)">ğŸ—‘ï¸</button>
            </div>
          </div>
        }
      </section>
    }
    @if (groupedTodos().older.length > 0) {
      <section class="todo-section">
        <h2 class="section-title">ğŸ—“ï¸ Older</h2>
        @for (todo of groupedTodos().older; track todo.id) {
          <div class="todo-card" [class]="getStatusClass(todo.status)">
            <div class="todo-content">
              <h3 class="todo-title">{{ todo.title }}</h3>
              <p class="todo-description">{{ todo.description }}</p>
              <div class="todo-meta">
                <span class="status-badge" [class]="getStatusClass(todo.status)">{{ todo.status }}</span>
                <span class="date">{{ formatDate(todo.createdAt) }}</span>
              </div>
            </div>
            <div class="todo-actions">
              <a [routerLink]="['/edit', todo.id]" class="btn btn-sm btn-edit">âœï¸ Edit</a>
              <button class="btn btn-sm btn-delete" (click)="deleteTodo(todo)">ğŸ—‘ï¸</button>
            </div>
          </div>
        }
      </section>
    }
  }
</div>
